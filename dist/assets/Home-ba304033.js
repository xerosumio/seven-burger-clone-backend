import{_ as ze,a as ye,u as fe,m as ve,r as n,q as be,s as _e,b as p,o as b,f as D,w as i,g as e,i as _,e as S,d as k,c as we,v as G,p as Ve,l as De}from"./index-7d12b6e0.js";import{a as Se,P as q,R as M,u as ge}from"./userAppwriteAccount-521291e1.js";const he=()=>{const{database:V,CONFIG:y,ID:F,storage:f}=Se(),R=async(u,s)=>{try{const c=await V.createDocument(y.DATABASE_ID,y.COLLECTION_ID,F.unique(),{...u},[q.read(M.user(s)),q.update(M.user(s)),q.delete(M.user(s))]);return await U(),c}catch(c){return c}},U=async()=>{try{return await V.listDocuments(y.DATABASE_ID,y.COLLECTION_ID)}catch(u){return u}};return{doCreateDocument:R,doListDocument:U,doUpdateDocument:async(u,s)=>{try{return await V.updateDocument(y.DATABASE_ID,y.COLLECTION_ID,u,s)}catch(c){return c}},doDeleteDocument:async u=>{try{return await V.deleteDocument(y.DATABASE_ID,y.COLLECTION_ID,u)}catch(s){return s}},doListFiles:async()=>{try{return await f.listFiles("64c76af65ba9bb99cc41")}catch(u){return u}},doGetFilePreview:async u=>{try{return await f.getFilePreview("64c76af65ba9bb99cc41",u)}catch(s){return s}},doCreateFile:async u=>{try{return await f.createFile("64c76af65ba9bb99cc41",F.unique(),u)}catch(s){return s}},doDeleteFile:async u=>{try{return await f.deleteFile("64c76af65ba9bb99cc41",u)}catch(s){return s}},doUpdateFile:async(u,s)=>{try{return await f.updateFile("64c76af65ba9bb99cc41",u,s)}catch(c){return c}}}};const ke=V=>(Ve("data-v-4e817565"),V=V(),De(),V),Ue=["src"],Ce=ke(()=>k("div",null,"内容",-1)),Ie=["src"],Fe=["src"],xe={class:"dialog-footer"},te="https://example.com/upload",w="140px",Te={__name:"Home",setup(V){const{logout:y}=ge(),{doCreateDocument:F,doListDocument:f,doListFiles:R,doGetFilePreview:U,doCreateFile:T,doDeleteDocument:j,doDeleteFile:A,doUpdateDocument:J,doUpdateFile:le}=he();ye();const K=fe(),Q=ve(()=>localStorage.getItem("userId")),u=n([]);be(async()=>{const a=await f();u.value=a==null?void 0:a.documents});const s=async()=>{try{const a=await y();if(a!=null&&a.error)throw a==null?void 0:a.error;K.push({path:"/"})}catch(a){console.log(a);return}},c=n(),L=n(),E=n(),O=n(),B=n(),N=n(),$=n(),h=n("pizza"),H=n(),P=n(),W=n(),X=n(),ae=async a=>{X.value=a;const t=new FileReader;return t.readAsDataURL(a),t.onload=d=>{P.value=d.target.result},!1},oe=async()=>{try{const a=await T(X.value);W.value=a.$id;const t=await U(W.value),d={title:c.value,subtitle:L.value,description:E.value,price:O.value,pizzaSize20:B.value,pizzaSize30:N.value,pizzaSize40:$.value,type:h.value,variousType:H.value,isHeart:!1,imgID:W.value,imgData:t.href},g=await F(d,Q.value),I=await f();if(u.value=I==null?void 0:I.documents,g!=null&&g.error)throw g==null?void 0:g.error;G({showClose:!0,message:"successfully add!",type:"success"})}catch(a){console.log(a);return}},ie=async a=>{try{await j(a.$id),await A(a.imgID);const t=await f();u.value=t==null?void 0:t.documents,G({showClose:!0,message:"successfully deleted!",type:"success"})}catch(t){console.log(t);return}},C=n(!1),l=_e({id:"",title:"",subtitle:"",description:"",price:"",pizzaSize20:"",pizzaSize30:"",pizzaSize40:"",type:"pizza",variousType:"",imgID:"",imgData:""}),Y=n(),ue=async a=>{Y.value=a;const t=new FileReader;return t.readAsDataURL(a),t.onload=d=>{l.imgData=d.target.result},!1},se=a=>{C.value=!0,l.id=a.$id,l.title=a.title,l.subtitle=a.subtitle,l.description=a.description,l.price=a.price,l.pizzaSize20=a.pizzaSize20,l.pizzaSize30=a.pizzaSize30,l.pizzaSize40=a.pizzaSize40,l.type=a.type,l.variousType=a.variousType,l.imgData=a.imgData,l.imgID=a.imgID},de=async()=>{try{await A(l.imgID);const a=await T(Y.value),t=await U(a.$id);await J(l.id,{title:l.title,subtitle:l.subtitle,description:l.description,price:l.price,pizzaSize20:l.pizzaSize20,pizzaSize30:l.pizzaSize30,pizzaSize40:l.pizzaSize40,type:l.type,variousType:l.variousType,imgID:a.$id,imgData:t.href});const d=await f();u.value=d==null?void 0:d.documents,C.value=!1,G({showClose:!0,message:"successfully update!",type:"success"})}catch(a){console.log(a);return}};return(a,t)=>{const d=p("el-button"),g=p("el-header"),I=p("el-aside"),r=p("el-input"),m=p("el-option"),x=p("el-select"),Z=p("el-upload"),z=p("el-table-column"),ne=p("el-table"),v=p("el-form-item"),re=p("el-form"),pe=p("el-dialog"),ce=p("el-main"),ee=p("el-container");return b(),D(ee,null,{default:i(()=>[e(g,null,{default:i(()=>[_("Header "),e(d,{type:"info",onClick:s},{default:i(()=>[_("退出")]),_:1})]),_:1}),e(ee,null,{default:i(()=>[e(I,null,{default:i(()=>[_("Aside")]),_:1}),e(ce,null,{default:i(()=>[e(r,{modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=o=>c.value=o),type:"text",placeholder:"title"},null,8,["modelValue"]),e(r,{modelValue:L.value,"onUpdate:modelValue":t[1]||(t[1]=o=>L.value=o),type:"text",placeholder:"subtitle"},null,8,["modelValue"]),e(r,{modelValue:E.value,"onUpdate:modelValue":t[2]||(t[2]=o=>E.value=o),type:"text",placeholder:"description"},null,8,["modelValue"]),e(x,{modelValue:h.value,"onUpdate:modelValue":t[3]||(t[3]=o=>h.value=o),placeholder:"type",style:{width:"115px"}},{default:i(()=>[e(m,{label:"pizza",value:"pizza"}),e(m,{label:"burger",value:"burger"}),e(m,{label:"desserts",value:"desserts"}),e(m,{label:"drinks",value:"drinks"})]),_:1},8,["modelValue"]),h.value!="pizza"?(b(),D(r,{key:0,modelValue:O.value,"onUpdate:modelValue":t[4]||(t[4]=o=>O.value=o),type:"text",placeholder:"price"},null,8,["modelValue"])):S("",!0),h.value=="pizza"?(b(),D(r,{key:1,modelValue:B.value,"onUpdate:modelValue":t[5]||(t[5]=o=>B.value=o),type:"text",placeholder:"pizzaSize20"},null,8,["modelValue"])):S("",!0),h.value=="pizza"?(b(),D(r,{key:2,modelValue:N.value,"onUpdate:modelValue":t[6]||(t[6]=o=>N.value=o),type:"text",placeholder:"pizzaSize30"},null,8,["modelValue"])):S("",!0),h.value=="pizza"?(b(),D(r,{key:3,modelValue:$.value,"onUpdate:modelValue":t[7]||(t[7]=o=>$.value=o),type:"text",placeholder:"pizzaSize40"},null,8,["modelValue"])):S("",!0),e(x,{modelValue:H.value,"onUpdate:modelValue":t[8]||(t[8]=o=>H.value=o),multiple:"",placeholder:"Select",style:{width:"240px"}},{default:i(()=>[e(m,{label:"popular",value:"popular"}),e(m,{label:"topWeek",value:"topWeek"})]),_:1},8,["modelValue"]),k("div",null,[e(Z,{class:"upload-demo",action:te,"show-file-list":!1,"before-upload":ae},{default:i(()=>[e(d,{size:"small",type:"primary"},{default:i(()=>[_("点击上传")]),_:1})]),_:1}),P.value?(b(),we("img",{key:0,src:P.value,style:{width:"200px",height:"200px"}},null,8,Ue)):S("",!0)]),e(d,{type:"info",onClick:oe},{default:i(()=>[_("添加")]),_:1}),Ce,e(ne,{data:u.value,style:{width:"100%"}},{default:i(()=>[e(z,{fixed:"",prop:"title",label:"title",width:"180"}),e(z,{"show-overflow-tooltip":"",prop:"subtitle",label:"subtitle",width:"180"}),e(z,{"show-overflow-tooltip":"",prop:"description",label:"description",width:"180"}),e(z,{prop:"price",label:"price"}),e(z,{prop:"pizzaSize20",label:"pizzaSize20"}),e(z,{prop:"pizzaSize30",label:"pizzaSize30"}),e(z,{prop:"pizzaSize40",label:"pizzaSize40"}),e(z,{prop:"type",label:"type"}),e(z,{prop:"variousType",label:"variousType"}),e(z,{prop:"isHeart",label:"isHeart"}),e(z,{label:"Image"},{default:i(o=>[k("img",{src:o.row.imgData,width:"50",height:"50"},null,8,Ie)]),_:1}),e(z,{fixed:"right",label:"Operations",width:"120"},{default:i(o=>[e(d,{link:"",type:"primary",size:"small",onClick:me=>ie(o.row)},{default:i(()=>[_("Delete")]),_:2},1032,["onClick"]),e(d,{link:"",type:"primary",size:"small",onClick:me=>se(o.row)},{default:i(()=>[_("Edit")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(pe,{modelValue:C.value,"onUpdate:modelValue":t[19]||(t[19]=o=>C.value=o),title:"Edit"},{footer:i(()=>[k("span",xe,[e(d,{onClick:t[18]||(t[18]=o=>C.value=!1)},{default:i(()=>[_("Cancel")]),_:1}),e(d,{type:"primary",onClick:de},{default:i(()=>[_(" Confirm ")]),_:1})])]),default:i(()=>[e(re,{model:l},{default:i(()=>[e(v,{label:"title","label-width":w},{default:i(()=>[e(r,{modelValue:l.title,"onUpdate:modelValue":t[9]||(t[9]=o=>l.title=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(v,{label:"subtitle","label-width":w},{default:i(()=>[e(r,{modelValue:l.subtitle,"onUpdate:modelValue":t[10]||(t[10]=o=>l.subtitle=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(v,{label:"description","label-width":w},{default:i(()=>[e(r,{modelValue:l.description,"onUpdate:modelValue":t[11]||(t[11]=o=>l.description=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(v,{label:"type","label-width":w},{default:i(()=>[e(x,{modelValue:l.type,"onUpdate:modelValue":t[12]||(t[12]=o=>l.type=o),placeholder:"type",style:{width:"115px"}},{default:i(()=>[e(m,{label:"pizza",value:"pizza"}),e(m,{label:"burger",value:"burger"}),e(m,{label:"desserts",value:"desserts"}),e(m,{label:"drinks",value:"drinks"})]),_:1},8,["modelValue"])]),_:1}),l.type!="pizza"?(b(),D(v,{key:0,label:"price","label-width":w},{default:i(()=>[e(r,{modelValue:l.price,"onUpdate:modelValue":t[13]||(t[13]=o=>l.price=o),autocomplete:"off"},null,8,["modelValue"])]),_:1})):S("",!0),l.type=="pizza"?(b(),D(v,{key:1,label:"pizzaSize20","label-width":w},{default:i(()=>[e(r,{modelValue:l.pizzaSize20,"onUpdate:modelValue":t[14]||(t[14]=o=>l.pizzaSize20=o),autocomplete:"off"},null,8,["modelValue"])]),_:1})):S("",!0),l.type=="pizza"?(b(),D(v,{key:2,label:"pizzaSize30","label-width":w},{default:i(()=>[e(r,{modelValue:l.pizzaSize30,"onUpdate:modelValue":t[15]||(t[15]=o=>l.pizzaSize30=o),autocomplete:"off"},null,8,["modelValue"])]),_:1})):S("",!0),l.type=="pizza"?(b(),D(v,{key:3,label:"pizzaSize40","label-width":w},{default:i(()=>[e(r,{modelValue:l.pizzaSize40,"onUpdate:modelValue":t[16]||(t[16]=o=>l.pizzaSize40=o),autocomplete:"off"},null,8,["modelValue"])]),_:1})):S("",!0),e(v,{label:"variousType","label-width":w},{default:i(()=>[e(x,{modelValue:l.variousType,"onUpdate:modelValue":t[17]||(t[17]=o=>l.variousType=o),multiple:"",placeholder:"Select",style:{width:"240px"}},{default:i(()=>[e(m,{label:"popular",value:"popular"}),e(m,{label:"topWeek",value:"topWeek"})]),_:1},8,["modelValue"])]),_:1}),e(v,{label:"img","label-width":w},{default:i(()=>[k("div",null,[k("img",{src:l.imgData,width:"80",height:"80"},null,8,Fe)]),e(Z,{class:"upload-demo",action:te,"show-file-list":!1,"before-upload":ue},{default:i(()=>[e(d,{size:"small",type:"primary"},{default:i(()=>[_("点击修改")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})}}},Ee=ze(Te,[["__scopeId","data-v-4e817565"]]);export{Ee as default};
